# RabbitMq

## 1. 协议
### 1.1 AMQP帧
#### 1.1.1 帧结构
![amqp帧结构][amqp_frame]
AMQP帧由五个不同的组件组成  
- 帧类型  
- 信道编号  
- 以字节为单位的帧大小  
- 帧有效载荷  
- 结束字节标记（ASCII值206）
> 帧类型，信道编号和帧大小组合起来称为帧头  

#### 1.1.2 帧类型
AMQP规范定义了5种类型的帧：  
- 协议头帧：用于连接道RabbitMQ，仅使用一次  
- 方法帧：方法帧携带发送给RabbitMQ或从RabbitMQ接收到的RPC请求或响应   
- 内容头帧：包括一条消息的大小和属性  
- 消息体帧：消息内容  
- 心跳帧： 由服务端发起？  


### 1.2 




[amqp_frame]:data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAakAAABbCAYAAADJAXr9AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAgtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8dGlmZjpDb21wcmVzc2lvbj41PC90aWZmOkNvbXByZXNzaW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPjI8L3RpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CobSriQAABmBSURBVHgB7Z0J3FXT+scXoURESSkKofgnGUrGlHnOFImUTEmG/vlcXG7X0I0yJEPmlJlcCQnVH5kz34xJQoOScJWh2vf3Xc46/9255/S+b2/17rPP83w+v7PXWnufvdfz2+s8z1rPWnsf50yMAWPAGDAGjIGEMrBaQutVkWot0cFp0KMiOtuxxoAxYAyUAgNRGox7JEnszVpttdWc1W/5b0/S+Vt+zeybxkDVM5D03xf1W73qabIaGAPGgDFgDBgD+RkwJ5WfFys1BowBY8AYSAAD5qQScBOsCsaAMWAMGAP5GTAnlZ8XKzUGjAFjwBhIAAPmpBJwE6wKxoAxYAwYA/kZMCeVnxcrNQaMAWPAGEgAA+akEnATrArGgDFgDBgD+RkwJ5WfFys1BowBY8AYWE4GZsyY4b799tsV8oyoOanYTXjwwQfdueeeGytJRnLmzJnumGOOcZtttplr3bq1e/7551d5xX777TfPzRZbbOGaNWvmrrvuumwdPvvsM3fggQe6Ro0auT333NO9+uqr2X0TJ050u+yySxa77bZbdl8aEs8888x/3Y+7777b0ZaWJZMmTXIXXHDBsg7x+1588UX3t7/9banjrrjiCvfaa68tVRbPvPDCC+6GG27IFtGm33jjDTd48OBsWTzRv39/vz+UvfXWW+7KK68MWduWIAPLa3NGjBjhNtlkE9ehQwe34447elsxYcIEz+D8+fMdD+fWrFnTrbPOOlm0bNlymQyvscy9JbJz9OjRDtx3333uxBNPTJzWJ598stt999294XvnnXfcIYcc4t5//33XsGHDVVZXDNmPP/7oJk+e7OgltW3b1tG4aIxHHnmkN2qHHXaYe+CBB9wRRxzhZs+e7VZffXX3+uuvu0MPPdSdffbZvq400jQJvcW11lprKZV++OEHz8eNN97oy2+99VbvwO+8887scTiS6tWruwEDBmTLQuKoo45yCxYscA899JBbtGiRu/feex2dBOScc87xbTVfO73kkku8w+T6v/zyi78XdBrIV6tWzb399tu+jXfp0sVNnTo129anTZvmy9dff31/jZ9++sl9//337umnn/Z5DE/Tpk192j5Kg4HlsTn333+/u/rqq93LL7/sttxySz+KwqZirz7//HPvlGDv66+/dnXq1Ck3kWmwGJV+LdKHH37oh6ZPPfWU+/33393tt99ebgLLOrCyrx3B2Ky33nreQay77rr+chj9o48+2nXr1q2sy5e5v7z1u+qqq9zhhx/uWrRo4c/Zvn1717t3b7fffvv57V133eXL586d65o0aeLmzZvnjXfXrl29Mdx2223dRhtt5A1zmZWKHVDe+sW+skqSixcvds2bN/fXwhnz6qtPP/3U56+99lrfWzzrrLOydaEX+eSTT/r8l19+6RhtMSLKJ/vss493Ku+++6779ddfXY0aNdzPP//satWq5XbeeWfXuHFjz3F43RYdCNpDkCeeeMK9+eabjnKkR48ernv37m6HHXZwjJL23nvvcKi/T9dcc43vWNDxQBi9Pfroo+6mm27KHmeJdDKQ7/e1LJvD8Y8//rgbNWqUHxVdeOGFboMNNnAXXXSR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